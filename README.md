# c-oop-user-struct

> C μ–Έμ–΄μ—μ„ κ°μ²΄ μ§€ν–¥ ν”„λ΅κ·Έλλ° κµ¬ν„ν•κΈ°

C μ–Έμ–΄μ—μ„ κµ¬μ΅°μ²΄μ™€ ν•¨μ ν¬μΈν„°λ¥Ό ν™μ©ν•μ—¬ κ°μ²΄ μ§€ν–¥ ν”„λ΅κ·Έλλ°μ ν•µμ‹¬ κ°λ…λ“¤μ„ κµ¬ν„ν•λ” λ°©λ²•μ„ λ³΄μ—¬μ£Όλ” κµμ΅μ© ν”„λ΅μ νΈμ…λ‹λ‹¤.

## π― ν”„λ΅μ νΈ λ©μ 

- C μ–Έμ–΄μ—μ„ ν΄λμ¤μ™€ κ°μ²΄ κ°λ… κµ¬ν„
- ν•¨μ ν¬μΈν„°λ¥Ό ν†µν• λ©”μ„λ“ κµ¬ν„
- μƒμ„±μ ν¨ν„΄κ³Ό μ ν•μ  μΊ΅μν™” κµ¬ν„
- OOP κ°λ…μ C μ–Έμ–΄ μ μ© ν•™μµ (ν•κ³„μ  ν¬ν•¨)

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
c-oop-user-struct/
β”β”€β”€ class.h      # User ν΄λμ¤ μ •μ λ° μΈν„°νμ΄μ¤
β”β”€β”€ class.c      # User ν΄λμ¤ κµ¬ν„
β”β”€β”€ main.c       # μ‚¬μ© μμ  λ° ν…μ¤νΈ
β””β”€β”€ README.md    # ν”„λ΅μ νΈ λ¬Έμ„
```

## π”§ μ£Όμ” κΈ°λ¥

### User ν΄λμ¤ κµ¬ν„

- **μ†μ„±**: μ΄λ¦„, λ‚μ΄, ν‚¤, λΈλ¬΄κ²
- **λ©”μ„λ“**:
  - Setter: `setName()`, `setAge()`, `setHeight()`, `setWeight()`
  - Getter: `getName()`, `getAge()`, `getHeight()`, `getWeight()`
  - μ ν‹Έλ¦¬ν‹°: `printUserInfo()`

### OOP κ°λ… κµ¬ν„

- **ν΄λμ¤**: κµ¬μ΅°μ²΄ + ν•¨μ ν¬μΈν„°
- **μƒμ„±μ**: `newUser()` ν•¨μ
- **μ ν•μ  μΊ΅μν™”**: static ν•¨μλ¥Ό ν†µν• λ©”μ„λ“ μ€λ‹‰ (ν•„λ“ μ€λ‹‰μ€ λ¶κ°€λ¥)
- **λ©”μ„λ“**: ν•¨μ ν¬μΈν„°λ¥Ό ν†µν• μΈμ¤ν„΄μ¤ λ©”μ„λ“

## π€ μ‚¬μ© λ°©λ²•

### μ»΄νμΌ

```bash
gcc -o user_program main.c class.c
```

### μ‹¤ν–‰

```bash
./user_program
```

### μμ  μ½”λ“

```c
#include "class.h"

int main() {
    // User κ°μ²΄ μƒμ„±
    pUser user = newUser("mike", 26, 178.4, 72.6);

    // μ‚¬μ©μ μ •λ³΄ μ¶λ ¥
    user->printUserInfo();

    // λ©”λ¨λ¦¬ ν•΄μ 
    free(user);

    return 0;
}
```

### μ‹¤ν–‰ κ²°κ³Ό

```
-------[user info]-------
  name   : mike
  age    : 26
  height : 178.40(cm)
  weight : 72.60(kg)
-------------------------
```

## π’΅ ν•µμ‹¬ κ°λ…

### 1. κµ¬μ΅°μ²΄ κΈ°λ° ν΄λμ¤

```c
typedef struct _user {
    const char* name;
    uInt age;
    float height;
    float weight;

    // λ©”μ„λ“ ν¬μΈν„°λ“¤
    void (*setName)(const char*);
    uInt (*getAge)();
    void (*printUserInfo)();
    // ...
} User, *pUser;
```

### 2. ν•¨μ ν¬μΈν„°λ¥Ό ν†µν• λ©”μ„λ“

- κµ¬μ΅°μ²΄ λ‚΄λ¶€μ— ν•¨μ ν¬μΈν„° μ„ μ–Έ
- μ΄κΈ°ν™” μ‹ μ‹¤μ  ν•¨μμ™€ μ—°κ²°
- κ°μ²΄μ²λΌ `user->printUserInfo()` ν•νƒλ΅ νΈμ¶ κ°€λ¥

### 3. Staticμ„ ν™μ©ν• μ ν•μ  μΊ΅μν™”

- **λ©”μ„λ“λ§** staticμΌλ΅ μ„ μ–Έν•μ—¬ private ν¨κ³Ό κµ¬ν„
- β οΈ κµ¬μ΅°μ²΄ λ©¤λ²„ λ³€μ(ν•„λ“)λ” static μ„ μ–Έ λ¶κ°€λ¥ (C μ–Έμ–΄ μ ν•)
- static λ©”μ„λ“λ” μ™Έλ¶€μ—μ„ μ§μ ‘ μ ‘κ·Ό λ¶κ°€λ¥
- κµ¬μ΅°μ²΄μ ν•¨μ ν¬μΈν„°λ¥Ό ν†µν•΄μ„λ§ μ ‘κ·Ό κ°€λ¥

## π“ ν•™μµ ν¬μΈνΈ

1. **C μ–Έμ–΄μ ν•κ³„**: μ§„μ •ν• OOP μ§€μ› λ¶€μ΅±
2. **μ°½μμ  ν•΄κ²°μ±…**: κµ¬μ΅°μ²΄μ™€ ν•¨μ ν¬μΈν„° ν™μ©
3. **λ©”λ¨λ¦¬ κ΄€λ¦¬**: λ™μ  ν• λ‹Ήκ³Ό ν•΄μ μ μ¤‘μ”μ„±
4. **μ„¤κ³„ ν¨ν„΄**: μƒμ„±μ ν¨ν„΄κ³Ό μ΄κΈ°ν™” κ³Όμ •

## β οΈ μ£Όμμ‚¬ν•­

- **μ™„μ „ν• μΊ΅μν™” λ¶κ°€λ¥**: `static` ν•„λ“λ” κµ¬μ΅°μ²΄ λ©¤λ²„λ΅ μ‚¬μ©ν•  μ μ—†μ–΄ λ©¤λ²„ λ³€μ μ€λ‹‰μ΄ λ¶κ°€λ¥
- **λ©”λ¨λ¦¬ κ΄€λ¦¬**: λ©”λ¨λ¦¬ λ„μ λ°©μ§€λ¥Ό μ„ν•΄ λ°λ“μ‹ `free()` νΈμ¶ ν•„μ”
- **Thread Safety**: μ „μ—­ `this` ν¬μΈν„°λ΅ μΈν• λ©€ν‹°μ¤λ λ“ ν™κ²½μ—μ„μ μ•μ „μ„± μ΄μ
- **μ§„μ •ν• OOP μ•„λ‹**: C μ–Έμ–΄μ ν•κ³„λ΅ μΈν•΄ OOPλ¥Ό λ¨λ°©ν• κ²ƒμΌ λΏ, μ§„μ •ν• κ°μ²΄ μ§€ν–¥μ€ μ•„λ‹

## π”— ν™•μ¥ κ°€λ¥μ„±

### π“ λ‹¤μ¤‘ κ°μ²΄ μ§€μ› κ°μ„ 

ν„μ¬ μ „μ—­ `this` ν¬μΈν„° λ°©μ‹μ€ **ν•λ‚μ κ°μ²΄λ§ λ™μ‹μ— μ²λ¦¬ν•  μ μλ” ν•κ³„**κ°€ μμµλ‹λ‹¤. ν•μ§€λ§ C μ–Έμ–΄μ—μ„ **self ν¬μΈν„°λ¥Ό λ…μ‹μ μΌλ΅ λ„κΈ°μ§€ μ•μΌλ©΄μ„λ„** κ°μ²΄μ λ©”μ„λ“λ¥Ό νΈμ¶ν•λ” λ°©λ²•μΌλ΅λ” **ν„μ¬ κµ¬ν„μ΄ μµμ„ μ μ ‘κ·Όλ²•**μ…λ‹λ‹¤.

**λ€μ•μ  μ ‘κ·Όλ²•λ“¤:**

- **λ…μ‹μ  self μ „λ‹¬**: `user_setName(user, "name")` ν•νƒ (Java/C++ μ¤νƒ€μΌ ν¬κΈ°)
- **μ¤λ λ“λ³„ μ €μ¥μ†**: `__thread` ν‚¤μ›λ“ ν™μ© (ν”λ«νΌ μΆ…μ†μ )
- **μ»¨ν…μ¤νΈ μ¤νƒ**: ν„μ¬ κ°μ²΄λ¥Ό μ¤νƒμΌλ΅ κ΄€λ¦¬ (λ³µμ΅μ„± μ¦κ°€)

### π§¬ μƒμ† κµ¬ν„ κ°€λ¥μ„±

**κµ¬μ΅°μ²΄ μ»΄ν¬μ§€μ…**μ„ ν†µν•΄ μƒμ† κµ¬ν„ κ°€λ¥:

```c
typedef struct {
    User super;      // λ¶€λ¨ ν΄λμ¤λ¥Ό μ²« λ²μ§Έ λ©¤λ²„λ΅ λ°°μΉ
    char* email;     // μ¶”κ°€ μ†μ„±
    char* phone;
} ExtendedUser;

// μ•μ „ν• μ—…μΊμ¤ν…: ExtendedUser* β†’ User*
User* base = (User*)&extended_user;
```

C ν‘μ¤€μ€ κµ¬μ΅°μ²΄μ μ²« λ²μ§Έ λ©¤λ²„κ°€ κµ¬μ΅°μ²΄ μ‹μ‘ μ£Όμ†μ™€ λ™μΌν•¨μ„ λ³΄μ¥ν•©λ‹λ‹¤.

### β΅ κ°€μƒ ν•¨μ ν…μ΄λΈ” (Vtable) κµ¬ν„ κ°€λ¥μ„±

**ν•¨μ ν¬μΈν„° ν…μ΄λΈ”**μ„ ν†µν•΄ λ‹¤ν•μ„± κµ¬ν„ κ°€λ¥:

```c
typedef struct {
    void (*draw)(Shape* self);
    double (*area)(Shape* self);
} ShapeVTable;

typedef struct {
    ShapeVTable* vtable;  // κ°€μƒ ν•¨μ ν…μ΄λΈ”
    int x, y;
} Shape;

// κ°€μƒ ν•¨μ νΈμ¶: shape->vtable->draw(shape);
```

λ‹¨, λ©”λ¨λ¦¬ μ¤λ²„ν—¤λ“μ™€ λ³µμ΅μ„±μ΄ ν¬κ² μ¦κ°€ν•©λ‹λ‹¤.

### π”§ μ λ„¤λ¦­/ν…ν”λ¦Ώ κµ¬ν„ κ°€λ¥μ„±

Cμ—μ„ μ λ„¤λ¦­ κµ¬ν„μ„ μ„ν• μ£Όμ” κΈ°λ²•λ“¤:

**1. λ§¤ν¬λ΅ κΈ°λ° ν…ν”λ¦Ώ**

```c
#define DECLARE_VECTOR(TYPE) \
    typedef struct { \
        TYPE* data; \
        size_t size; \
    } Vector_##TYPE;
```

**2. Template Headers (κ¶μ¥)**

```c
// vector.h - λ‹¤μ¤‘ ν¬ν•¨ κ°€λ¥ν• ν—¤λ”
#ifndef T
#error "T must be defined"
#endif

typedef struct {
    T* data;
    size_t count;
} Vector;
```

**3. Void ν¬μΈν„° + ν¬κΈ° μ •λ³΄**

```c
typedef struct {
    void* data;
    size_t element_size;
    size_t count;
} GenericVector;
```

### π’΅ κ¶μ¥μ‚¬ν•­

- **λ‹¨μν• κ²½μ°**: ν„μ¬ κµ¬μ΅° μ μ§€ (κ°€μ¥ μ§κ΄€μ )
- **μƒμ† ν•„μ”μ‹**: κµ¬μ΅°μ²΄ μ»΄ν¬μ§€μ… ν™μ©
- **λ‹¤ν•μ„± ν•„μ”μ‹**: ν•¨μ ν¬μΈν„° ν…μ΄λΈ” κ²€ν† 
- **μ λ„¤λ¦­ ν•„μ”μ‹**: Template Headers λ°©μ‹ μ¶”μ²
- **λ³µμ΅ν• OOP**: C++ μ‚¬μ©

## β–οΈ λΌμ΄μ„ μ¤

λ¨λ“  μ½”λ“μ μƒμ—…λ©μ  μ‚¬μ©μ„ κΈμ§€ν•λ©°, κµμ΅ λ©μ μΌλ΅λ§ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.
